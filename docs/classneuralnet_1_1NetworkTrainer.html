<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>neuralnet: neuralnet::NetworkTrainer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">neuralnet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>neuralnet</b></li><li class="navelem"><a class="el" href="classneuralnet_1_1NetworkTrainer.html">NetworkTrainer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classneuralnet_1_1NetworkTrainer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">neuralnet::NetworkTrainer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Network's training wrapper.  
 <a href="classneuralnet_1_1NetworkTrainer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="network__trainer_8hpp_source.html">network_trainer.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for neuralnet::NetworkTrainer:</div>
<div class="dyncontent">
<div class="center"><img src="classneuralnet_1_1NetworkTrainer__coll__graph.png" border="0" usemap="#neuralnet_1_1NetworkTrainer_coll__map" alt="Collaboration graph"/></div>
<!-- MAP 0 -->
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4feb5bee93881dd4cd2f72cf9b957bf9"><td class="memItemLeft" align="right" valign="top"><a id="a4feb5bee93881dd4cd2f72cf9b957bf9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>NetworkTrainer</b> (<a class="el" href="classneuralnet_1_1Net.html">Net</a> &amp;neural_network)</td></tr>
<tr class="separator:a4feb5bee93881dd4cd2f72cf9b957bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40f48d1edbe380ba8ef8e7782dbe7903"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnet_1_1NetworkTrainer.html#a40f48d1edbe380ba8ef8e7782dbe7903">Train</a> (const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;inputs, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;target_outputs, double learning_rate, double momentum, int num_epochs)</td></tr>
<tr class="memdesc:a40f48d1edbe380ba8ef8e7782dbe7903"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trains the network with provided training data and labels.  <a href="#a40f48d1edbe380ba8ef8e7782dbe7903">More...</a><br /></td></tr>
<tr class="separator:a40f48d1edbe380ba8ef8e7782dbe7903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b19c85c1b35c36a8a1ee607857bf25"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnet_1_1NetworkTrainer.html#a41b19c85c1b35c36a8a1ee607857bf25">Test</a> (const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;inputs, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;labels)</td></tr>
<tr class="memdesc:a41b19c85c1b35c36a8a1ee607857bf25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests network's prediction accuracy on test data with 'one hot' labels.  <a href="#a41b19c85c1b35c36a8a1ee607857bf25">More...</a><br /></td></tr>
<tr class="separator:a41b19c85c1b35c36a8a1ee607857bf25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a779928ec8b2d74240d6b705f46ecf08a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classneuralnet_1_1Net.html">Net</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnet_1_1NetworkTrainer.html#a779928ec8b2d74240d6b705f46ecf08a">neural_network_</a></td></tr>
<tr class="separator:a779928ec8b2d74240d6b705f46ecf08a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Network's training wrapper. </p>
<p>This class menages network's training on provided dataset. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a41b19c85c1b35c36a8a1ee607857bf25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41b19c85c1b35c36a8a1ee607857bf25">&#9670;&nbsp;</a></span>Test()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void neuralnet::NetworkTrainer::Test </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tests network's prediction accuracy on test data with 'one hot' labels. </p>
<p>Labels to each input have to be a 'one hot' vectors. For each input trainer propagates it forward and schecks which neuron of network's output layer returned the largest value and compares it with provided label. If the label corresponding to that neuron has value 1, output is counted as correct. This function accepts input in form of mini-batches with size being multiples of size of the network's input layer, each input of a mini-batch laid in columns of a matrix stored as a vector using row major ordering.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputs</td><td>Vector of mini-batches of test data. </td></tr>
    <tr><td class="paramname">labels</td><td>Vector of mini-batches of labels corresponding to test data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a40f48d1edbe380ba8ef8e7782dbe7903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40f48d1edbe380ba8ef8e7782dbe7903">&#9670;&nbsp;</a></span>Train()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void neuralnet::NetworkTrainer::Train </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>target_outputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>learning_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>momentum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_epochs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Trains the network with provided training data and labels. </p>
<p>Trains the network with provided training data and labels using mini-batch gradient descent with momentum. This function accepts input in form of mini-batches with size being multiples of size of the network's input layer, each input of a mini-batch laid in columns of a matrix stored as a vector using row major ordering. Each mini-batch is propagated forward and then backward through a network and then the network is updated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputs</td><td>Vector of mini-batches of training data. </td></tr>
    <tr><td class="paramname">target_outputs</td><td>Vector of mini-batches of labels corresponding to the training data. </td></tr>
    <tr><td class="paramname">learning_rate</td><td>Speed with which this network accepts new information. Pick this value carefully because if it's too big network can diverge, and if it's too small it will take a long time time to converge. </td></tr>
    <tr><td class="paramname">momentum</td><td>Momentum coefficient for velocity calculation in momentum gradient descent algorithm. This value is usually 0.9 or 0.99. </td></tr>
    <tr><td class="paramname">num_epochs</td><td>Number of forward-backward passes through the entire training data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument("learning_rate</td><td>has to be a positive number.")
@throws std::invalid_argument("momentum coefficient should have a value between 0 and 1.") </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a779928ec8b2d74240d6b705f46ecf08a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779928ec8b2d74240d6b705f46ecf08a">&#9670;&nbsp;</a></span>neural_network_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classneuralnet_1_1Net.html">Net</a>&amp; neuralnet::NetworkTrainer::neural_network_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Network being a subject to training. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="network__trainer_8hpp_source.html">network_trainer.hpp</a></li>
<li>src/network_trainer.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
